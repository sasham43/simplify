/*! simplify 2016-07-26 */
angular.module("simplifyApp",["ngRoute"]),angular.module("simplifyApp").config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"/views/splash.html",controller:"SplashController",controllerAs:"sc"}).when("/login",{templateUrl:"/views/login.html",controller:"LoginController",controllerAs:"lc"}).when("/albums",{templateUrl:"/views/albums.html",controller:"AlbumsController",controllerAs:"ac"}).when("/album",{templateUrl:"/views/album.html",controller:"ExamineController",controllerAs:"ec"}),b.html5Mode(!0)}]),angular.module("simplifyApp").controller("IndexController",["$http","$location",function(a,b){var c=this;c.checkLocation=function(){"/"==b.url()?c.showNav=!1:c.showNav=!0},c.checkLocation()}]),angular.module("simplifyApp").controller("SplashController",["$http","$location",function(a,b){console.log("Splash controller loaded.",b.url())}]),angular.module("simplifyApp").controller("AlbumsController",["UserTrackFactory","AlbumFactory",function(a,b){var c=this;c.user={},c.albums=b.albums,a.getUserInfo().then(function(a){c.user=a.data}),c.getAlbums=function(){c.spinning=!0,b.getAlbums(c.stopSpin)},c.stopSpin=function(){c.spinning=!1},c.updateAlbums=function(){c.spinning=!0,b.updateAlbums(c.stopSpin)},c.showAlbumOverlay=function(a){a.show=!0},c.hideAlbumOverlay=function(a){a.show=!1},c.examineAlbum=function(a){b.examineAlbum(a)},c.getAlbums(c.stopSpin),console.log("albums controller loaded.")}]),angular.module("simplifyApp").controller("ExamineController",["AlbumFactory","$scope",function(a,b){var c=this;c.currentAlbum=a.currentAlbum.album,c.trackCount=0,c.currentlyPlaying=!1;var d=io();d.on("socket connected",function(a){console.log("socket connected")}),d.on("track playing",function(a){console.log("playing track:",a.name),b.$apply(function(){c.currentlyPlaying=!0}),console.log("ec.currentlyPlaying",c.currentlyPlaying)}),d.on("track paused",function(a){b.$apply(function(){c.currentlyPlaying=!1}),console.log("track paused",c.currentlyPlaying)}),d.on("track finished",function(a){console.log("track finished"),b.$apply(function(){c.trackCount++}),c.trackCount<=c.currentAlbum.tracks.length-1?c.playTrack(c.trackCount):d.emit("stop track")}),c.playTrack=function(a){d.emit("play track",{album:c.currentAlbum,trackNumber:a})},c.prevTrack=function(){c.trackCount--,c.playTrack(c.trackCount)},c.nextTrack=function(){c.trackCount++,c.playTrack(c.trackCount)},c.pauseTrack=function(){d.emit("pause track")},c.trackMarker=function(a){return a==c.trackCount}}]),angular.module("simplifyApp").factory("AlbumFactory",["$http","$location",function(a,b){var c=[],d={album:{}},e=function(b){a.get("/spotify/albums/stored").then(function(a){console.log("Stored album response:",a.data,b),angular.copy(a.data.storedAlbums,c),b()})},f=function(b){a.get("/spotify/albums/update").then(function(a){console.log("Album response:",a.data,b),e(b)})},g=function(a){b.url("/album"),d.album=a,console.log("examining album:",a)},h=function(b){var c=0,d=function(){a.post("/play/track/",b.tracks[c]).then(function(a){console.log("track ended?",a.data),"track playing"===a.data.message?console.log("playing:",b.tracks[c].track_name):"track finished"===a.data.message&&(console.log("track ended."),d())})};d()},i=function(b){a.get("/play/track/"+b.track_link).then(function(a){})};return{currentAlbum:d,examineAlbum:g,updateAlbums:f,albums:c,getAlbums:e,playAlbum:h,playTrack:i}}]),angular.module("simplifyApp").factory("UserTrackFactory",["$http",function(a){var b={},c=function(){return a.get("/authorize/info")};return{user:b,getUserInfo:c}}]);