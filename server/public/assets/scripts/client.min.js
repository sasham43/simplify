/*! simplify 2016-07-25 */
angular.module("simplifyApp",["ngRoute"]),angular.module("simplifyApp").config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"/views/splash.html",controller:"SplashController",controllerAs:"sc"}).when("/login",{templateUrl:"/views/login.html",controller:"LoginController",controllerAs:"lc"}).when("/albums",{templateUrl:"/views/albums.html",controller:"AlbumsController",controllerAs:"ac"}).when("/album",{templateUrl:"/views/album.html",controller:"ExamineController",controllerAs:"ec"}),b.html5Mode(!0)}]),angular.module("simplifyApp").controller("IndexController",["$http","$location",function(a,b){var c=this;c.checkLocation=function(){"/"==b.url()?c.showNav=!1:c.showNav=!0},c.checkLocation(),console.log("Index controller loaded.",b.url())}]),angular.module("simplifyApp").controller("SplashController",["$http","$location",function(a,b){console.log("Splash controller loaded.",b.url())}]),angular.module("simplifyApp").controller("AlbumsController",["UserTrackFactory","AlbumFactory",function(a,b){var c=this;console.log("albums here?",c.albums),c.user={},c.albums=b.albums,a.getUserInfo().then(function(a){c.user=a.data,console.log("User info:",c.user)}),c.getAlbums=function(){c.spinning=!0,b.getAlbums(c.stopSpin)},c.stopSpin=function(){c.spinning=!1},c.updateAlbums=function(){c.spinning=!0,b.updateAlbums(c.stopSpin)},c.showAlbumOverlay=function(a){a.show=!0},c.hideAlbumOverlay=function(a){a.show=!1},c.examineAlbum=function(a){b.examineAlbum(a)},c.getAlbums(c.stopSpin),console.log("albums controller loaded.",c.albums)}]),angular.module("simplifyApp").controller("ExamineController",["AlbumFactory",function(a){var b=this;b.currentAlbum=a.currentAlbum.album,b.showAlbumOverlay=function(){b.showOverlay=!0},b.hideAlbumOverlay=function(){b.showOverlay=!1},b.analyzeTrack=function(b){a.analyzeTrack(b)},b.analyzeAlbum=function(b){a.analyzeAlbum(b)},b.trackCount=0;var c=io();c.on("track playing",function(a){console.log("playing track:",a.name)}),c.on("socket connected",function(a){console.log("socket connected")}),c.on("track finished",function(a){console.log("track finished"),b.trackCount++,b.trackCount<=b.currentAlbum.tracks.length-1&&b.playTrack(b.trackCount)}),b.playTrack=function(a){c.emit("play track",b.currentAlbum.tracks[a])},b.prevTrack=function(){b.trackCount--,b.playTrack(b.trackCount)},b.nextTrack=function(){b.trackCount++,b.playTrack(b.trackCount)},b.trackHighlight=function(a){if(a==b.trackCount)return{"background-color":"chartreuse",color:"#333"}},console.log("examine controller loaded.",b.currentAlbum)}]),angular.module("simplifyApp").factory("AlbumFactory",["$http","$location",function(a,b){var c=[],d={album:{}},e={features:{}},f={},g=function(b){a.get("/spotify/albums/stored").then(function(a){console.log("Stored album response:",a.data,b),angular.copy(a.data.storedAlbums,c),b()})},h=function(b){a.get("/spotify/albums/update").then(function(a){console.log("Album response:",a.data,b),g(b)})},i=function(c){b.url("/album"),d.album=c,console.log("examining album:",c),a.post("/spotify/album-features",c.tracks).then(function(a){console.log("album features response:",a.data),d.album=c,d.album.tracks=a.data})},j=function(b){a.get("/spotify/track-features/"+b.id).then(function(a){console.log("track feature response:",a.data),e.features=a.data})},k=function(b){a.post("/spotify/album-features",b).then(function(a){console.log("album features response:",a.data),f.features=a.data})},l=function(b){var c=0,d=function(){a.post("/play/track/",b.tracks[c]).then(function(a){console.log("track ended?",a.data),"track playing"===a.data.message?console.log("playing:",b.tracks[c].track_name):"track finished"===a.data.message&&(console.log("track ended."),d())})};d()},m=function(b){a.get("/play/track/"+b.track_link).then(function(a){})};return{currentAlbum:d,examineAlbum:i,updateAlbums:h,albums:c,analyzeTrack:j,features:e,analyzeAlbum:k,albumFeatures:f,getAlbums:g,playAlbum:l,playTrack:m}}]),angular.module("simplifyApp").factory("UserTrackFactory",["$http",function(a){var b={},c=function(){return a.get("/authorize/info")};return{user:b,getUserInfo:c}}]);