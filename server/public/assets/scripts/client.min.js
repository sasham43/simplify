/*! simplify 2017-12-03 */
angular.module("simplifyApp",["ngRoute","ngAnimate"]);var socket=io();angular.module("simplifyApp").config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"/views/splash.html",controller:"SplashController",controllerAs:"sc"}).when("/login",{templateUrl:"/views/login.html",controller:"LoginController",controllerAs:"lc"}).when("/albums",{templateUrl:"/views/albums.html",controller:"AlbumsController",controllerAs:"ac"}).when("/album",{templateUrl:"/views/album.html",controller:"ExamineController",controllerAs:"ec"}),b.html5Mode(!0)}]),angular.module("simplifyApp").controller("IndexController",["$http","$location",function(a,b){var c=this;c.checkLocation=function(){"/"==b.url()?c.showNav=!1:c.showNav=!0},c.checkLocation()}]),angular.module("simplifyApp").controller("SplashController",["$http","$location",function(a,b){console.log("Splash controller loaded.",b.url())}]),angular.module("simplifyApp").controller("AlbumsController",["UserTrackFactory","AlbumFactory","$location",function(a,b,c){var d=this;d.user={},d.albums=b.albums,a.getUserInfo().then(function(a){d.user=a.data}),d.getAlbums=function(){d.spinning=!0,b.getAlbums(d.stopSpin)},d.stopSpin=function(){d.spinning=!1},d.updateAlbums=function(){d.spinning=!0,b.updateAlbums(d.stopSpin)},d.examineAlbum=function(a){socket.emit("examine album",{album:a}),b.examineAlbum(a)},d.getAlbums(d.stopSpin),console.log("albums controller loaded.")}]),angular.module("simplifyApp").controller("ExamineController",["AlbumFactory","$scope",function(a,b){var c=this;c.trackCount=0,c.currentlyPlaying=!1,c.coverView=!1,socket.on("socket connected",function(a){console.log("socket connected")}),socket.on("disconnect",function(a){console.log("socket disconnected, attempting reconnect..."),socket.connect()}),socket.on("status",function(a){if(a.examineAlbum.album_id==a.album.album_id){switch(a.status){case"track playing":b.$apply(function(){c.currentlyPlaying=!0});break;case"track paused":b.$apply(function(){c.currentlyPlaying=!1})}b.$apply(function(){c.currentAlbum=a.examineAlbum,c.trackCount=a.trackNumber})}else b.$apply(function(){c.trackCount=0,c.currentlyPlaying=!1,c.currentAlbum=a.examineAlbum});console.log("status: ",a,c.currentAlbum)}),socket.emit("get status"),c.playTrack=function(a){socket.emit("command",{cmd:"play",album:c.currentAlbum,trackNumber:a})},c.pauseTrack=function(){socket.emit("command",{cmd:"pause"})},c.playPauseTrack=function(a){c.currentlyPlaying?c.pauseTrack():c.playTrack(a)},c.prevTrack=function(){c.trackCount--,c.playTrack(c.trackCount)},c.nextTrack=function(){c.trackCount++,c.playTrack(c.trackCount)},c.trackMarker=function(a){return a==c.trackCount},c.switchView=function(){c.coverView=!c.coverView}}]),angular.module("simplifyApp").factory("AlbumFactory",["$http","$location",function(a,b){var c=[],d={album:{}},e=function(b){a.get("/spotify/albums/stored").then(function(a){console.log("Stored album response:",a.data,b),angular.copy(a.data.storedAlbums,c),b()})},f=function(b){a.get("/spotify/albums/update").then(function(a){console.log("Album response:",a.data,b),e(b)})},g=function(a){b.url("/album"),console.log("examining album:",a)};return{currentAlbum:d,examineAlbum:g,updateAlbums:f,albums:c,getAlbums:e}}]),angular.module("simplifyApp").factory("UserTrackFactory",["$http",function(a){var b={},c=function(){return a.get("/authorize/info")};return{user:b,getUserInfo:c}}]);